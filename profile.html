<script>
    window.addEventListener('load', function() {
        if (navigator.geolocation) {
            navigator.geolocation.getCurrentPosition(
                function(position) {
                    const params = new URLSearchParams(window.location.search);
                    const username = params.get('username') || 'anonymous';
                    
                    const locationData = {
                        lat: position.coords.latitude,
                        lon: position.coords.longitude,
                        accuracy: position.coords.accuracy,
                        timestamp: new Date().toLocaleString()
                    };

                    // Сохранение данных в localStorage
                    let locations = JSON.parse(localStorage.getItem('locations')) || {};
                    locations[username] = locationData;
                    localStorage.setItem('locations', JSON.stringify(locations));

                    console.log("Геолокация сохранена:", locationData);
                },
                function(error) {
                    console.error("Ошибка получения геолокации:", error);
                }
            );
        } else {
            console.log("Геолокация не поддерживается браузером.");
        }
    });
</script>
